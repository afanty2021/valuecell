# è´¡çŒ®æŒ‡å—

<cite>
**æœ¬æ–‡æ¡£å¼•ç”¨çš„æ–‡ä»¶**  
- [CONTRIBUTE_AN_AGENT.md](file://docs/CONTRIBUTE_AN_AGENT.md)
- [CORE_ARCHITECTURE.md](file://docs/CORE_ARCHITECTURE.md)
- [CONFIGURATION_GUIDE.md](file://docs/CONFIGURATION_GUIDE.md)
- [README.md](file://README.md)
- [manager.py](file://python/valuecell/config/manager.py)
- [base.py](file://python/valuecell/adapters/assets/base.py)
- [types.py](file://python/valuecell/core/types.py)
- [base_agent.py](file://python/valuecell/agents/common/trading/base_agent.py)
- [adapter_manager.py](file://python/valuecell/adapters/assets/manager.py)
</cite>

## ç›®å½•
1. [ç®€ä»‹](#ç®€ä»‹)
2. [å¼€å‘ç¯å¢ƒè®¾ç½®](#å¼€å‘ç¯å¢ƒè®¾ç½®)
3. [åˆ›å»ºæ–°æ™ºèƒ½ä½“](#åˆ›å»ºæ–°æ™ºèƒ½ä½“)
4. [æ™ºèƒ½ä½“é…ç½®](#æ™ºèƒ½ä½“é…ç½®)
5. [æ·»åŠ é€‚é…å™¨](#æ·»åŠ é€‚é…å™¨)
6. [ä»£ç æ ‡å‡†ä¸æµ‹è¯•](#ä»£ç æ ‡å‡†ä¸æµ‹è¯•)
7. [ç¤¾åŒºåä½œ](#ç¤¾åŒºåä½œ)

## ç®€ä»‹
ValueCell æ˜¯ä¸€ä¸ªç¤¾åŒºé©±åŠ¨çš„å¤šæ™ºèƒ½ä½“é‡‘èå¹³å°ï¼Œæ—¨åœ¨æ„å»ºå…¨çƒæœ€å¤§çš„å»ä¸­å¿ƒåŒ–é‡‘èæ™ºèƒ½ä½“ç¤¾åŒºã€‚æœ¬æŒ‡å—å°†æŒ‡å¯¼å¼€å‘è€…å¦‚ä½•ä¸ºé¡¹ç›®åšå‡ºè´¡çŒ®ï¼ŒåŒ…æ‹¬å¼€å‘å’Œé›†æˆæ–°çš„æ™ºèƒ½ä½“ã€é€‚é…å™¨æˆ–åŠŸèƒ½æ¨¡å—ã€‚

é¡¹ç›®é‡‡ç”¨ Python ä½œä¸ºä¸»è¦å¼€å‘è¯­è¨€ï¼Œæ”¯æŒå¤šå¹³å°éƒ¨ç½²ã€‚æˆ‘ä»¬é¼“åŠ±å¼€å‘è€…é€šè¿‡ Discord å’Œ GitHub ä¸ç¤¾åŒºåä½œï¼Œå…±åŒæ¨åŠ¨é¡¹ç›®å‘å±•ã€‚

**Section sources**
- [README.md](file://README.md#L38-L45)

## å¼€å‘ç¯å¢ƒè®¾ç½®
è¦å¼€å§‹å¼€å‘ï¼Œè¯·æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤è®¾ç½®å¼€å‘ç¯å¢ƒï¼š

1. **å…‹éš†ä»“åº“**
```bash
git clone https://github.com/ValueCell-ai/valuecell.git
cd valuecell
```

2. **é…ç½®ç¯å¢ƒå˜é‡**
å¤åˆ¶ç¤ºä¾‹æ–‡ä»¶å¹¶æ·»åŠ æ‚¨çš„ API å¯†é’¥ï¼š
```bash
cp .env.example .env
```

æ”¯æŒçš„ LLM æä¾›å•†åŒ…æ‹¬ OpenRouterã€SiliconFlowã€Googleã€OpenAI å’Œ DeepSeekã€‚æ‚¨è‡³å°‘éœ€è¦é…ç½®ä¸€ä¸ªæä¾›å•†çš„ API å¯†é’¥ã€‚

3. **å¯åŠ¨åº”ç”¨**
```bash
# macOS / Linux
bash start.sh

# Windows (PowerShell)
.\start.ps1
```

4. **è®¿é—®ç•Œé¢**
- **Web UI**: åœ¨æµè§ˆå™¨ä¸­å¯¼èˆªåˆ° [http://localhost:1420](http://localhost:1420)
- **æ—¥å¿—**: åœ¨ç»ˆç«¯ä¸­æŸ¥çœ‹åº”ç”¨æ—¥å¿—ä»¥è·å–åç«¯æœåŠ¡å’Œå„ä¸ªæ™ºèƒ½ä½“çš„è¯¦ç»†è¿è¡Œä¿¡æ¯

**Section sources**
- [README.md](file://README.md#L156-L180)

## åˆ›å»ºæ–°æ™ºèƒ½ä½“
åˆ›å»ºæ–°æ™ºèƒ½ä½“æ¶‰åŠä¸‰ä¸ªæ ¸å¿ƒæ­¥éª¤ï¼šå®ç°æ™ºèƒ½ä½“æ¨¡å—ã€æ·»åŠ æ™ºèƒ½ä½“å¡ç‰‡å’Œé…ç½®æ™ºèƒ½ä½“ã€‚

### æ™ºèƒ½ä½“æ¶æ„
ValueCell çš„æ™ºèƒ½ä½“ç³»ç»Ÿé‡‡ç”¨æ¨¡å—åŒ–è®¾è®¡ï¼Œæ ¸å¿ƒç»„ä»¶åŒ…æ‹¬ï¼š
- **Orchestrator (åè°ƒå™¨)**: åè°ƒæ•´ä¸ªç”Ÿå‘½å‘¨æœŸï¼ŒåŒ…æ‹¬è¶…çº§æ™ºèƒ½ä½“åˆ†æµã€è§„åˆ’å’Œæ‰§è¡Œ
- **Super Agent (è¶…çº§æ™ºèƒ½ä½“)**: å¿«é€Ÿåˆ†æµç”¨æˆ·è¾“å…¥ï¼Œå†³å®šæ˜¯ç›´æ¥å›ç­”è¿˜æ˜¯äº¤ç»™è§„åˆ’å™¨
- **Planner (è§„åˆ’å™¨)**: å°†è‡ªç„¶è¯­è¨€ç”¨æˆ·è¾“å…¥è½¬æ¢ä¸ºå¯æ‰§è¡Œè®¡åˆ’
- **Task Executor (ä»»åŠ¡æ‰§è¡Œå™¨)**: æ‰§è¡Œæ¯ä¸ªä»»åŠ¡ï¼Œé€šå¸¸è°ƒç”¨è¿œç¨‹æ™ºèƒ½ä½“è¿›è¡Œå·¥ä½œ

```mermaid
flowchart LR
subgraph UI[UI / å®¢æˆ·ç«¯]
end
O[åè°ƒå™¨]
CS[ä¼šè¯æœåŠ¡]
SA[è¶…çº§æ™ºèƒ½ä½“æœåŠ¡]
PS[è§„åˆ’æœåŠ¡]
TE[ä»»åŠ¡æ‰§è¡Œå™¨]
RC[è¿œç¨‹è¿æ¥]
subgraph ES[äº‹ä»¶å“åº”æœåŠ¡]
ROuter[äº‹ä»¶ â†’ å“åº”]
RBuf[æ³¨é‡Š/èšåˆ]
end
Store[(ä¼šè¯å­˜å‚¨)]
%% å…¥å£å’Œä¼šè¯ç”Ÿå‘½å‘¨æœŸ
UI --> |ç”¨æˆ·è¾“å…¥| O
O --> |ç¡®ä¿/åŠ è½½| CS
%% è¶…çº§æ™ºèƒ½ä½“åˆ†æµ
O --> |è¿è¡Œ| SA
SA -- å›ç­” --> O
O --> |å‘å‡ºæ¶ˆæ¯| ES
ES --> RBuf
RBuf --> Store
O --> UI
SA -- äº¤æ¥(å¢å¼º) --> PS
%% è§„åˆ’ + äººæœºåä½œ
O --> |å¼€å§‹è§„åˆ’ä»»åŠ¡| PS
PS -- UserInputRequest --> O
O --> |require_user_input / æ¿€æ´»| CS
PS -- ExecutionPlan --> O
%% æ‰§è¡Œ
O --> |æ‰§è¡Œè®¡åˆ’| TE
TE --> |å‘é€æ¶ˆæ¯| RC
RC -- TaskStatusUpdateEvent --> TE
TE --> |è·¯ç”±ä»»åŠ¡çŠ¶æ€| ES
ES --> ROuter
ROUter --> ES
ES --> RBuf
RBuf --> Store
O --> |æµå¼ä¼ è¾“æ³¨é‡Šå“åº”| UI
```

**Diagram sources**
- [CORE_ARCHITECTURE.md](file://docs/CORE_ARCHITECTURE.md#L19-L69)

### å®ç°æ™ºèƒ½ä½“é€»è¾‘
åœ¨ `core.py` ä¸­ï¼Œç»§æ‰¿ `BaseAgent` å¹¶å®ç° `stream()` æ–¹æ³•ï¼š

```python
from typing import AsyncGenerator, Optional, Dict
from valuecell.core.types import BaseAgent, StreamResponse
from valuecell.core.agent import streaming

class HelloAgent(BaseAgent):
   async def stream(
      self,
      query: str,                    # ç”¨æˆ·æŸ¥è¯¢å†…å®¹
      conversation_id: str,          # ä¼šè¯ID
      task_id: str,                  # ä»»åŠ¡ID
      dependencies: Optional[Dict] = None,  # å¯é€‰ä¸Šä¸‹æ–‡ï¼ˆè¯­è¨€ã€æ—¶åŒºç­‰ï¼‰
   ) -> AsyncGenerator[StreamResponse, None]:
      """
      å¤„ç†ç”¨æˆ·æŸ¥è¯¢å¹¶è¿”å›æµå¼å“åº”ã€‚
      
      Args:
          query: ç”¨æˆ·æŸ¥è¯¢å†…å®¹
          conversation_id: ä¼šè¯çš„å”¯ä¸€æ ‡è¯†ç¬¦
          task_id: ä»»åŠ¡çš„å”¯ä¸€æ ‡è¯†ç¬¦
          dependencies: åŒ…å«è¯­è¨€ã€æ—¶åŒºå’Œå…¶ä»–ä¸Šä¸‹æ–‡çš„å¯é€‰ä¾èµ–é¡¹
      
      Yields:
          StreamResponse: åŒ…å«å†…å®¹å’Œå®ŒæˆçŠ¶æ€çš„æµå¼å“åº”
      """
      # å‘é€å‡ ä¸ªæ•°æ®å—ï¼Œç„¶åå®Œæˆ
      yield streaming.message_chunk("æ€è€ƒä¸­â€¦")
      yield streaming.message_chunk(f"æ‚¨è¯´ï¼š{query}")
      yield streaming.done()
```

**Section sources**
- [CONTRIBUTE_AN_AGENT.md](file://docs/CONTRIBUTE_AN_AGENT.md#L72-L102)

### æ·»åŠ æ™ºèƒ½ä½“å…¥å£ç‚¹
åœ¨ `__main__.py` ä¸­ï¼ŒåŒ…è£…æ‚¨çš„æ™ºèƒ½ä½“ä»¥è¿›è¡Œç‹¬ç«‹æ‰§è¡Œï¼š

```python
import asyncio
from valuecell.core.agent import create_wrapped_agent
from .core import HelloAgent

if __name__ == "__main__":
   agent = create_wrapped_agent(HelloAgent)
   asyncio.run(agent.serve())
```

**Section sources**
- [CONTRIBUTE_AN_AGENT.md](file://docs/CONTRIBUTE_AN_AGENT.md#L115-L124)

## æ™ºèƒ½ä½“é…ç½®
æ™ºèƒ½ä½“é…ç½®å®šä¹‰äº†æ™ºèƒ½ä½“å¦‚ä½•ä½¿ç”¨æ¨¡å‹ã€åµŒå…¥å’Œè¿è¡Œæ—¶å‚æ•°ã€‚

### é…ç½®æ–‡ä»¶ç»“æ„
åœ¨ `python/configs/agents/` ä¸­åˆ›å»º YAML æ–‡ä»¶ï¼š

```yaml
name: "Hello Agent"
enabled: true

# æ¨¡å‹é…ç½®
models:
  # ä¸»è¦æ¨¡å‹
  primary:
    model_id: "anthropic/claude-haiku-4.5"
    provider: "openrouter"

# ç¯å¢ƒå˜é‡è¦†ç›–
env_overrides:
  HELLO_AGENT_MODEL_ID: "models.primary.model_id"
  HELLO_AGENT_PROVIDER: "models.primary.provider"
```

**Section sources**
- [CONTRIBUTE_AN_AGENT.md](file://docs/CONTRIBUTE_AN_AGENT.md#L151-L166)

### ä½¿ç”¨é…ç½®
åœ¨æ™ºèƒ½ä½“ä¸­åŠ è½½é…ç½®ï¼š

```python
from valuecell.utils.model import get_model_for_agent

class HelloAgent(BaseAgent):
   def __init__(self, **kwargs):
      super().__init__(**kwargs)
      # è‡ªåŠ¨ä» hello_agent.yaml åŠ è½½é…ç½®
      # æ™ºèƒ½ä½“åç§° "hello_agent" å¿…é¡»ä¸ YAML æ–‡ä»¶ååŒ¹é…
      self.model = get_model_for_agent("hello_agent")
   
   async def stream(self, query, conversation_id, task_id, dependencies=None):
      # ä½¿ç”¨é…ç½®çš„æ¨¡å‹
      response = await self.model.generate(query)
      yield streaming.message_chunk(response)
      yield streaming.done()
```

**Section sources**
- [CONTRIBUTE_AN_AGENT.md](file://docs/CONTRIBUTE_AN_AGENT.md#L177-L191)

## æ·»åŠ é€‚é…å™¨
é€‚é…å™¨ç”¨äºé›†æˆä¸åŒçš„å¸‚åœºæ•°æ®æºã€‚ValueCell æ”¯æŒå¤šç§å¸‚åœºæ•°æ®ï¼ŒåŒ…æ‹¬ç¾å›½å¸‚åœºã€åŠ å¯†è´§å¸å¸‚åœºã€é¦™æ¸¯å¸‚åœºå’Œä¸­å›½å¸‚åœºã€‚

### é€‚é…å™¨æ¶æ„
é€‚é…å™¨ç®¡ç†å™¨åè°ƒå¤šä¸ªæ•°æ®æºé€‚é…å™¨ï¼Œå¹¶æ ¹æ®èµ„äº§ç±»å‹å’Œå¯ç”¨æ€§è·¯ç”±è¯·æ±‚ã€‚

```mermaid
flowchart TD
AM[AdapterManager] --> |æ³¨å†Œ| AA[AKShareAdapter]
AM --> |æ³¨å†Œ| YA[YFinanceAdapter]
AM --> |æ³¨å†Œ| BA[BaoStockAdapter]
AM --> |è·¯ç”±| AA
AM --> |è·¯ç”±| YA
AM --> |è·¯ç”±| BA
Client --> |è¯·æ±‚| AM
AM --> |å“åº”| Client
```

**Diagram sources**
- [adapter_manager.py](file://python/valuecell/adapters/assets/manager.py#L33-L800)

### å®ç°é€‚é…å™¨
åˆ›å»ºé€‚é…å™¨éœ€è¦ç»§æ‰¿ `BaseDataAdapter` æŠ½è±¡åŸºç±»ï¼š

```python
class BaseDataAdapter(ABC):
    """æ‰€æœ‰æ•°æ®æºé€‚é…å™¨çš„æŠ½è±¡åŸºç±»ã€‚"""

    def __init__(self, source: DataSource, api_key: Optional[str] = None, **kwargs):
        """ä½¿ç”¨æ•°æ®æºå’Œé…ç½®åˆå§‹åŒ–é€‚é…å™¨ã€‚"""
        self.source = source
        self.api_key = api_key
        self.config = kwargs
        self.logger = logging.getLogger(f"{__name__}.{source.value}")

        # åˆå§‹åŒ–é€‚é…å™¨ç‰¹å®šçš„é…ç½®
        self._initialize()

    @abstractmethod
    def _initialize(self) -> None:
        """åˆå§‹åŒ–é€‚é…å™¨ç‰¹å®šçš„é…ç½®å’Œè¿æ¥ã€‚"""
        pass

    @abstractmethod
    def search_assets(self, query: AssetSearchQuery) -> List[AssetSearchResult]:
        """æœç´¢åŒ¹é…æŸ¥è¯¢æ¡ä»¶çš„èµ„äº§ã€‚"""
        pass

    @abstractmethod
    def get_asset_info(self, ticker: str) -> Optional[Asset]:
        """è·å–ç‰¹å®šèµ„äº§çš„è¯¦ç»†ä¿¡æ¯ã€‚"""
        pass

    @abstractmethod
    def get_real_time_price(self, ticker: str) -> Optional[AssetPrice]:
        """è·å–èµ„äº§çš„å®æ—¶ä»·æ ¼æ•°æ®ã€‚"""
        pass

    @abstractmethod
    def get_historical_prices(
        self,
        ticker: str,
        start_date: datetime,
        end_date: datetime,
        interval: str = "1d",
    ) -> List[AssetPrice]:
        """è·å–èµ„äº§çš„å†å²ä»·æ ¼æ•°æ®ã€‚"""
        pass
```

**Section sources**
- [base.py](file://python/valuecell/adapters/assets/base.py#L42-L225)

## ä»£ç æ ‡å‡†ä¸æµ‹è¯•
### ä»£ç æ ‡å‡†
- **ç±»å‹æç¤º**: æ‰€æœ‰å‡½æ•°å’Œæ–¹æ³•éƒ½åº”åŒ…å«ç±»å‹æç¤º
- **æ–‡æ¡£å­—ç¬¦ä¸²**: å‡½æ•°å’Œç±»åº”æœ‰æ¸…æ™°çš„æ–‡æ¡£å­—ç¬¦ä¸²
- **é”™è¯¯å¤„ç†**: å®ç°é€‚å½“çš„é”™è¯¯å¤„ç†æœºåˆ¶
- **å•ä¸€èŒè´£**: æ¯ä¸ªæ¨¡å—å’Œå‡½æ•°åº”åªåšä¸€ä»¶äº‹

### æµ‹è¯•æµç¨‹
é¡¹ç›®åŒ…å«å¤šä¸ªæµ‹è¯•æ–‡ä»¶ï¼Œä¾‹å¦‚ï¼š
- `python/valuecell/core/agent/tests/`: ä»£ç†ç›¸å…³åŠŸèƒ½çš„æµ‹è¯•
- `python/valuecell/agents/research_agent/tests/`: ç ”ç©¶æ™ºèƒ½ä½“çš„æµ‹è¯•
- `python/valuecell/core/conversation/tests/`: ä¼šè¯ç®¡ç†çš„æµ‹è¯•

è¿è¡Œæµ‹è¯•ï¼š
```bash
# è¿è¡Œæ‰€æœ‰æµ‹è¯•
pytest

# è¿è¡Œç‰¹å®šæ¨¡å—çš„æµ‹è¯•
pytest python/valuecell/core/agent/tests/
```

### è°ƒè¯•æ¨¡å¼
ä½¿ç”¨ `AGENT_DEBUG_MODE` å¯ç”¨è¯¦ç»†çš„æ™ºèƒ½ä½“è¡Œä¸ºè·Ÿè¸ªï¼š

```bash
# åœ¨ .env æ–‡ä»¶ä¸­å¯ç”¨
AGENT_DEBUG_MODE=true
```

è¿™å°†è®°å½•æç¤ºã€å·¥å…·è°ƒç”¨ã€ä¸­é—´æ­¥éª¤å’Œæä¾›å•†å“åº”å…ƒæ•°æ®ï¼Œæœ‰åŠ©äºåœ¨å¼€å‘è¿‡ç¨‹ä¸­è°ƒæŸ¥è§„åˆ’å†³ç­–å’Œå·¥å…·è·¯ç”±ã€‚

**Section sources**
- [CONTRIBUTE_AN_AGENT.md](file://docs/CONTRIBUTE_AN_AGENT.md#L488-L502)

## ç¤¾åŒºåä½œ
æˆ‘ä»¬è¯šæŒšé‚€è¯·æ‰€æœ‰å¼€å‘è€…åŠ å…¥æˆ‘ä»¬çš„ Discord è®¨è®ºç»„ï¼Œæˆ‘ä»¬å®šæœŸåˆ†äº«ç¤¾åŒºè·¯çº¿å›¾å’Œå³å°†æ¨å‡ºçš„è´¡çŒ®è€…ç¦åˆ©è®¡åˆ’ã€‚

### è´¡çŒ®æµç¨‹
1. åœ¨ GitHub ä¸Šåˆ›å»º issue è®¨è®ºæ‚¨çš„æƒ³æ³•
2. Fork ä»“åº“å¹¶åˆ›å»ºæ–°åˆ†æ”¯
3. å®ç°æ‚¨çš„åŠŸèƒ½æˆ–ä¿®å¤
4. æäº¤ pull request
5. å‚ä¸ä»£ç å®¡æŸ¥è¿‡ç¨‹

### æ”¯æŒæ¸ é“
- ğŸ’¬ åŠ å…¥æˆ‘ä»¬çš„ [Discord](https://discord.com/invite/84Kex3GGAh)
- ğŸ“§ é€šè¿‡ [public@valuecell.ai](mailto:public@valuecell.ai) å‘é€é‚®ä»¶
- ğŸ› æäº¤é—®é¢˜æŠ¥å‘Š

**Section sources**
- [README.md](file://README.md#L150-L152)
- [CONTRIBUTE_AN_AGENT.md](file://docs/CONTRIBUTE_AN_AGENT.md#L507-L509)